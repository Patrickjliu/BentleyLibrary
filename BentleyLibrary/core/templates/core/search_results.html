{% extends 'base.html' %}

{% block title %}Search Results{% endblock %}

{% block content %}
    
    <div class="container mx-auto px-4 py-8">
        <div class="grid grid-cols-4 gap-8">
            <!-- Sidebar for filters -->
            <div class="col-span-1 sm:w-full md:w-full lg:w-full xl:w-full">

                <div class="col-span-1">
                    <div class="bg-gray-200 rounded-lg p-4">
                        <h2 class="text-xl font-semibold mb-4">Filters</h2>
                        <!-- Filter form for published_date -->
                        <form method="GET" action="{% url 'search_results' %}">
                            <label class="block text-sm font-medium text-gray-700 mb-1">Published Date Range</label>
                                <div class="flex space-x-4">
                                    <input type="text" name="published_date_start" value="{{ published_date_start_filter }}" placeholder="YYYY-MM-DD" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400">
                                    <input type="text" name="published_date_end" value="{{ published_date_end_filter }}" placeholder="YYYY-MM-DD" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400">
                                </div>
                            <!-- Filter form for available_quantity -->
                            <label class="block text-sm font-medium text-gray-700 mb-1 mt-2">Available Quantity</label>
                            <input type="text" name="available_quantity" value="{{ available_quantity_filter }}" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-400">
                            <button class="w-full bg-blue-500 text-white font-semibold rounded hover:bg-blue-600 py-2 mt-2">Apply Filters</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Search bar and results -->
            <div class="col-span-3">
                <h1 class="text-3xl font-bold mb-4">Search Results</h1>
                {% if results %}
                    <h2 class="text-2xl font-bold mb-4">Found {{ results.count }} results for "{{ query }}"</h2>
                    <div class="grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
                      {% for book in results %}
                      <a href="{% url 'book_page' book.id %}" class="block mb-4">
                          <div class="bg-white rounded-lg shadow-md p-4 flex flex-col justify-between">
                              <div>
                                  <h3 class="text-lg font-semibold mb-2">{{ book.title }}</h3>
                                  <p class="text-sm text-gray-600 mb-2">{{ book.author }}</p>
                                  <img src="{{ book.image_url }}" alt="{{ book.title }}" class="max-w-full mb-2"> <!-- Added margin-bottom -->
                                  <p class="text-sm text-gray-800 mb-1"><span class="font-bold">ISBN:</span> {{ book.isbn }}</p> <!-- Adjusted margin-bottom -->
                                  <p class="text-sm text-gray-800 mb-1"><span class="font-bold">Publisher:</span> {{ book.publisher }}</p>
                                  <p class="text-sm text-gray-800 mb-1"><span class="font-bold">Quantity:</span> {{ book.quantity }}</p>
                                  <p class="text-sm text-gray-800 mb-1"><span class="font-bold">Available Quantity:</span> {{ book.available_quantity }}</p>
                              </div>
                          </div>
                      </a>
                      {% endfor %}
                  </div>     
                {% else %}
                    <p class="text-lg">No results found.</p>
                {% endif %}
            </div>
        </div>
    </div>
</body>
</html>
{% endblock %}